<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Chargement Articles</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 2rem; max-width: 1200px; margin: 0 auto; }
        .article-card { border: 1px solid #ddd; padding: 1rem; margin: 1rem 0; border-radius: 8px; }
        .article-title { font-weight: bold; color: #333; margin-bottom: 0.5rem; }
        .article-meta { font-size: 0.9em; color: #666; }
        .stats { background: #f0f0f0; padding: 1rem; border-radius: 8px; margin-bottom: 2rem; }
        .error { background: #ffebee; color: #c62828; padding: 1rem; border-radius: 8px; margin: 1rem 0; }
        .success { background: #e8f5e8; color: #2e7d32; padding: 1rem; border-radius: 8px; margin: 1rem 0; }
    </style>
</head>
<body>
    <h1>üß™ Test de Chargement des Articles</h1>
    
    <div id="stats" class="stats">
        <strong>Chargement en cours...</strong>
    </div>

    <div id="results"></div>

    <script>
        async function testArticleLoading() {
            const statsDiv = document.getElementById('stats');
            const resultsDiv = document.getElementById('results');
            
            try {
                statsDiv.innerHTML = '<strong>üì° Chargement du fichier articles-reels-extraits.json...</strong>';
                
                const response = await fetch('articles-reels-extraits.json');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('Donn√©es brutes:', data);
                
                // D√©terminer si c'est un tableau ou un objet
                const articles = Array.isArray(data) ? data : (data.articles || []);
                console.log('Articles extraits:', articles);
                
                statsDiv.innerHTML = `
                    <div class="success">
                        <strong>‚úÖ Chargement r√©ussi !</strong><br>
                        üìä Nombre d'articles: ${articles.length}<br>
                        üìÅ Type de donn√©es: ${Array.isArray(data) ? 'Tableau direct' : 'Objet avec propri√©t√© articles'}<br>
                        üìè Taille du fichier: ${JSON.stringify(data).length} caract√®res
                    </div>
                `;
                
                if (articles.length === 0) {
                    resultsDiv.innerHTML = '<div class="error">‚ùå Aucun article trouv√© dans le fichier</div>';
                    return;
                }
                
                // Afficher les articles
                resultsDiv.innerHTML = `
                    <h2>üìö Articles trouv√©s (${articles.length})</h2>
                    ${articles.map((article, index) => `
                        <div class="article-card">
                            <div class="article-title">${index + 1}. ${article.title || 'Titre manquant'}</div>
                            <div class="article-meta">
                                <strong>Cat√©gorie:</strong> ${article.category || 'Non d√©finie'} | 
                                <strong>Date:</strong> ${article.date || 'Non d√©finie'} | 
                                <strong>ID:</strong> ${article.id || 'Non d√©fini'}
                            </div>
                            <div style="margin-top: 0.5rem;">
                                <strong>Description:</strong> ${article.description ? 
                                    (article.description.substring(0, 100) + (article.description.length > 100 ? '...' : '')) : 
                                    'Pas de description'
                                }
                            </div>
                            <div style="margin-top: 0.5rem;">
                                <strong>Contenu:</strong> ${article.content ? 
                                    (article.content === 'Contenu non trouv√©' ? 
                                        '<span style="color: orange;">‚ö†Ô∏è Contenu non trouv√©</span>' : 
                                        '‚úÖ Contenu disponible (' + article.content.length + ' caract√®res)'
                                    ) : 
                                    '‚ùå Pas de contenu'
                                }
                            </div>
                        </div>
                    `).join('')}
                `;
                
                // Statistiques par cat√©gorie
                const categories = {};
                articles.forEach(article => {
                    const cat = article.category || 'Non d√©finie';
                    categories[cat] = (categories[cat] || 0) + 1;
                });
                
                resultsDiv.innerHTML += `
                    <h2>üìä R√©partition par cat√©gorie</h2>
                    <div class="stats">
                        ${Object.entries(categories).map(([cat, count]) => 
                            `<strong>${cat}:</strong> ${count} articles`
                        ).join('<br>')}
                    </div>
                `;
                
            } catch (error) {
                console.error('Erreur:', error);
                statsDiv.innerHTML = `
                    <div class="error">
                        <strong>‚ùå Erreur de chargement</strong><br>
                        ${error.message}
                    </div>
                `;
                
                resultsDiv.innerHTML = `
                    <div class="error">
                        <h3>D√©tails de l'erreur:</h3>
                        <pre>${error.stack || error.message}</pre>
                        
                        <h3>Solutions possibles:</h3>
                        <ul>
                            <li>V√©rifiez que le serveur HTTP est d√©marr√©</li>
                            <li>V√©rifiez que le fichier articles-reels-extraits.json existe</li>
                            <li>V√©rifiez la syntaxe JSON du fichier</li>
                            <li>V√©rifiez les permissions de lecture du fichier</li>
                        </ul>
                    </div>
                `;
            }
        }
        
        // Lancer le test au chargement de la page
        document.addEventListener('DOMContentLoaded', testArticleLoading);
    </script>
</body>
</html>
